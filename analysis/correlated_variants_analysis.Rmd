---
title: "correlated variants analysis"
date: "2024-07-09"
output:
  workflowr::wflow_html:
    code_folding: hide
    toc: true
---





```{r, message=F, warning=F}
rm(list=ls())
set.seed(123)
library(knitr)
library(RSQLite)
library(dplyr)
library(mirage)
```




* In top 18 genes, most variants (over 95%) within each gene have correlation less than 0.5


```
cat text_hist_BF1.txt

AHNAK.1.lsr2.hist.txt

>=           <              31805

<0           0.1          31791.000000

0.1          0.2          4.000000

0.2          0.3          0.000000

0.3          0.4          0.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          1.000000

0.8          0.9          0.000000

0.9          >1           9.000000

ARAP2.1.lsr2.hist.txt

>=           <              6398

<0           0.1          6397.000000

0.1          0.2          0.000000

0.2          0.3          1.000000

0.3          0.4          0.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           0.000000

ATP2B2.1.lsr2.hist.txt

>=           <              1437

<0           0.1          1437.000000

0.1          0.2          0.000000

0.2          0.3          0.000000

0.3          0.4          0.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           0.000000

BTG3.1.lsr2.hist.txt

>=           <              112

<0           0.1          112.000000

0.1          0.2          0.000000

0.2          0.3          0.000000

0.3          0.4          0.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           0.000000

IL1R2.1.lsr2.hist.txt

>=           <              922

<0           0.1          918.000000

0.1          0.2          2.000000

0.2          0.3          0.000000

0.3          0.4          1.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           1.000000

KATNAL1.1.lsr2.hist.txt

>=           <              228

<0           0.1          227.000000

0.1          0.2          0.000000

0.2          0.3          0.000000

0.3          0.4          0.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           1.000000

LMNB1.1.lsr2.hist.txt

>=           <              336

<0           0.1          335.000000

0.1          0.2          0.000000

0.2          0.3          0.000000

0.3          0.4          0.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          1.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           0.000000

MFSD10.1.lsr2.hist.txt

>=           <              847

<0           0.1          847.000000

0.1          0.2          0.000000

0.2          0.3          0.000000

0.3          0.4          0.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           0.000000

MYH10.1.lsr2.hist.txt

>=           <              3319

<0           0.1          3318.000000

0.1          0.2          0.000000

0.2          0.3          0.000000

0.3          0.4          0.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           1.000000

MYO5C.1.lsr2.hist.txt

>=           <              7015

<0           0.1          7014.000000

0.1          0.2          0.000000

0.2          0.3          1.000000

0.3          0.4          0.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           0.000000

NAV3.1.lsr2.hist.txt

>=           <              6852

<0           0.1          6849.000000

0.1          0.2          0.000000

0.2          0.3          0.000000

0.3          0.4          0.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           3.000000

OR52A5.1.lsr2.hist.txt

>=           <              520

<0           0.1          519.000000

0.1          0.2          0.000000

0.2          0.3          0.000000

0.3          0.4          0.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           1.000000

PAN2.1.lsr2.hist.txt

>=           <              2063

<0           0.1          2062.000000

0.1          0.2          0.000000

0.2          0.3          1.000000

0.3          0.4          0.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           0.000000

PCYOX1L.1.lsr2.hist.txt

>=           <              883

<0           0.1          882.000000

0.1          0.2          0.000000

0.2          0.3          0.000000

0.3          0.4          0.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           1.000000

PLXNA1.1.lsr2.hist.txt

>=           <              6910

<0           0.1          6904.000000

0.1          0.2          1.000000

0.2          0.3          0.000000

0.3          0.4          0.000000

0.4          0.5          1.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           4.000000

PTPRF.1.lsr2.hist.txt

>=           <              8877

<0           0.1          8874.000000

0.1          0.2          1.000000

0.2          0.3          0.000000

0.3          0.4          1.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           1.000000

SF3B3.1.lsr2.hist.txt

>=           <              509

<0           0.1          509.000000

0.1          0.2          0.000000

0.2          0.3          0.000000

0.3          0.4          0.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           0.000000

SYNGAP1.1.lsr2.hist.txt

>=           <              639

<0           0.1          639.000000

0.1          0.2          0.000000

0.2          0.3          0.000000

0.3          0.4          0.000000

0.4          0.5          0.000000

0.5          0.6          0.000000

0.6          0.7          0.000000

0.7          0.8          0.000000

0.8          0.9          0.000000

0.9          >1           0.000000
```



## Analysis of all transmitted variants aggregated


```{r, echo=F, message=F, warning=F, eval=F}
################## DO NOT RUN ########################
path="C:\\Shengtong\\research\\rare-var\\"

mirage_input=as_tibble(read.table(paste(path, "ASC\\Laura_result\\mirage_input_20231013.txt", sep=""), header=T))
N_all=14578  # from Laura's script: NOTES_wrap_mirage_100323
mirage_input_remove_variant=mirage_input %>% filter(Variant!="11:62516748:T:G") # from Laura, 11:62516748:T:G is highly correlated with 11:62519568:T:G in gene AHNAK, remove one variant and see how BF changes 
res=mirage(data.frame(mirage_input_remove_variant),n1=N_all,n2=N_all,gamma=c(6,6,6,3,3,3),delta.init = 0.05,estimate.delta = FALSE)
############# output subset of input data
#mirage_input_for_gnomAD_AF=mirage_input %>% select(Variant, Gene)
#write.csv(mirage_input_for_gnomAD_AF, file=paste(path, "ASC\\Laura_result\\mirage_input_for_gnomAD_AF_20231106.csv", sep=""))

########### output top ASD genes for LD computation 
Top_ASD_gene=BF_proband_AllGene_sorted %>% select(Gene) %>% pull()
mirage_input_top_ASD_gene=mirage_input %>% filter(Gene %in% Top_ASD_gene[1:18]==T) # 18 genes are selected with PP>0.5
#write.csv(mirage_input_top_ASD_gene, file="../output/LauraData/mirage_input_for_top_ASD_gene_2023_1107.csv")
```
